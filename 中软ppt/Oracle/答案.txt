--1、查询员工表所有数据
select * from yuangong
--2、查询总裁的基本工资
select jibengongzi from yuangong
where yuangongzhiwei='总裁'
--3、所有奖金为空的员工
select * from yuangong
where jiangjin is null
--4、查询基本工资最高的三个人
select * from (select * from yuangong order by jibengongzi) where rownum<=3

select * from yuangong
where jibengongzi in (
	select jibengongzi from (
		select distinct jibengongzi from yuangong order by jibengongzi desc
	) where rownum<=3
)

--5、查询技术部的所在地
select bumendizhi from bumen
where bumenname='技术部'
--6、查询部门编号为30且奖金大于300元的员工信息
select * from yuangong
where bumenid=30 and jiangjin>300
--7、查询部门编号为20的员工中基本工资最高的员工姓名和工资
select yuangongname,jibengongzi+nvl(jiangjin,0) as gongzi
from yuangong
where bumenid=20 and jibengongzi in (
	select max(jibengongzi) from yuangong where bumenid = 20
)
--8、查询位于'嵩山'、'黑木崖'、'南海神宫'的部门信息
select * from bumen
where bumendizhi in ('嵩山','黑木崖','南海神宫')
--9、查询入职日期在1981-5-1到1981-12-31之间的所有员工
select * from yuangong
where ruzhiriqi between  and 
--10、查询所有名字为三个字的员工的员工编号,姓名
select yuangongid,yuangongname from yuangong
where yuangongname like '___'

select yuangongid,yuangongname from yuangong
where length(yuangongname)=3
--11、查询10号部门的所有经理和20号部门的所有职员的详细信息
select * from yuangong
where bumenid=10 and yuangongzhiwei='经理' or bumenid=20 and yuangongzhiwei='职员'
--12、查询姓名中没有‘王’字的员工的详细信息
select * from yuangong
where yuangongname not like '%王%'

select * from yuangong
where instr(yuangongname,'王')=0
--13、查询员工姓名，将工作年限最长的员工排在最前面
select yuangongname,trunc(sysdate-ruzhiriqi) ruzhidaynum from yuangong
ruzhidaynum ruzhidaynum desc
select yuangongname from yuangong
order by ruzhiriqi asc

--14、查询'任我行'的基本工资
select jibengongzi from yuangong where yuangongname='任我行'

--15、查询基本工资比'任我行'多的所有员工的姓名和基本工资
select yuangongname,jibengongzi from yuangong
where jibengongzi>(select jibengongzi from yuangong where yuangongname='任我行')

--16、查询各个部门经理的基本工资
select jibengongzi from yuangong
where yuangongzhiwei = '经理'

--17、查询与'东方不败'从事相同工作的员工的详细信息
select * from yuangong
where yuangongzhiwei in (
select yuangongzhiwei from yuangong where yuangongname='东方不败')
and yuangongname<>'东方不败'

--18、查询市场部员工的姓名
select yuangongname from yuangong
where bumenid in (select bumenid from bumen where bumenname='市场部')

--19、查询某些员工的姓名和基本工资，
--条件是他们的基本工资与部门30中某一个员工的基本工资相同
select yuangongname,jibengongzi
from yuangong
where bumenid<>30 and jibengongzi in (
select distinct jibengongzi from yuangong where bumenid = 30
)

--20、查询奖金收入比基本工资高的员工的详细信息
select * from yuangong where val(jiangjin,0)>jibengongzi	

-----------------------------------5---------------------------------------------
--21、查询不同部门的平均基本工资
select avg(jibengongzi) from yuangong group by bumenid
	
--22、查询所有基本工资高于平均基本工资（平均基本工资为所有部门员工的基本工资平均数）的销售人员
select * from yuangong
where yuangongzhiwei='销售人员'
and jibengongzi>(select avg(jibengongzi) from yuangong)

--23、显示各种职位的最低基本工资
select yuangongzhiwei,min(jibengongzi)
from yuangong
group by yuangongzhiwei 

--24、查询每个部门的人数
select bumenid,count(*)
from yuangong
group by bumenid

--25、查询每个部门入职最早的员工的入职时间和部门编号
select bumenid,min(ruzhiriqi)
from yuangong
group by bumenid

--26、显示所有职员的姓名及其所在部门的名称
等值连接：
select y.yuangongname,b.bumenname
from yuangong y,bumen b
where y.bumenid = b.bumenid

内连接：
select y.yangongname,b.bumenname
from yuangong y inner join bumen b on y.bumenid = b.bumenid

--27、显示所有员工的姓名、所在部门名称和基本工资
select y.yangongname,b.bumenname,y.jibengongzi
from yuangong y,bumen b
where y.bumenid = b.bumenid

--28、显示不同部门不同职位的平均基本工资,部门名称，职位
select avg(y.jibengongzi) pingjungongzi,b.bumenname,y.yuangongzhiwei
from yuangong y,bumen b
where y.bumenid=b.bumenid
group by y.yuangongzhiwei,b.bumenname
order by pingjungongzi desc

--29、查询部门平均工资大于员工平均工资（全体员工平均工资）的部门编号和平均工资
select avg(jibengongzi),bumenid
from yuangong
group by bumenid
having avg(jibengongzi)>(select avg(jibengongzi) from yuangong)

select avg(y.jibengongzi),n.bumenname
from yuangong
where y.bumenid=b.bumenid
group by b.bumenname
having avg(jibengongzi)>(select avg(jibengongzi) from yuangong)

--30、查询没有员工的部门名称
select b.bumenname,count(y.yuangongid)
from yuangong y right outer join bumen b
on y.bumenid = b.bumenid
group by b.bumenname
having count(y.yuangongid)=0

select *
from bumen b
where bumenid not in (select distinct nvl(bumenid,0) from yuangong)

--31、查询 部门当中每个员工基本工资都大于1200的部门名称
select b.bumenname
from yuangong y, bumen b
where y.bumenid = b.bumenid
group by b.bumenname
having min(y.jibengongzi) >1200



-----------------------提高----------------------------------------------------
--32、查询在神龙岛工作员工的编号，姓名，工作部门，工作所在地
--33、查询各个部门员工的人数
--34、查询各个岗位员工基本工资大于平均基本工资（平均基本工资包括所有员工）的人数和员工职位
select count(yuangongid) num,yuangongzhiwei
from yuangong
where jibengongzi>(select avg(jibengongzi)from yuangong)
group by yuangongzhiwei
order by num desc

--35、查询基本工资相同的员工的基本工资和姓名
select * from yuangong where jibengongzi in (
  select jibengongzi
  from yuangong
  group by jibengongzi
  having count(*)>1
)

select distinct y1.* from yuangong y1, yuangong y2
where y1.jibengongzi=y2.jibengongzi
and y1.yuangongname <> y2.yuangongname

--36、查询员工的基本工资排名第3-6位的姓名和基本工资
select * from yuangong
where yuangongid in (select yuangongid from 
      (select * from yuangong order by jibengongzi desc) where rownum<=20)
and yuangongid not in(select yuangongid from 
      (select * from yuangong order by jibengongzi desc) where rownum<=10)
order by jibengongzi desc

--37、查询员工的基本信息，附加其上级的姓名
select y1.yuangongid,y1.yuangongname,nvl(y2.yuangongname,'--')
from yuangong y1 left outer join yuangong y2
on y1.jingliid = y2.yuangongid

--38、查询员工的基本信息，附加其基本工资的排名(基本工资相同的按奖金订先后，如果奖金相同则并列)
select (
       select count(*)+1 from yuangong 
       where jibengongzi>y.jibengongzi 
       or jibengongzi=y.jibengongzi 
       and nvl(jiangjin,0)>nvl(y.jiangjin,0)
       ) paiming,y.* 
from yuangong y
order by paiming 

--39、查询部门中基本工资不小于2000的人数不止1人的部门名称和人数
select b.bumenname,count(*)
from yuangong y,bumen b
where y.bumenid=b.bumenid
and jibengongzi>=2000
group by b.bumenname
having count(*)>1
order by count(*) desc
