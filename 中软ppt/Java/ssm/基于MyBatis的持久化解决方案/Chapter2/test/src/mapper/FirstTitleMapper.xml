<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.FirstTitleMapper">

  <cache></cache>

  <resultMap type="firstTitle" id="ftResultMap">
    <id property="fid" column="fid"></id>
    <result property="titleName" column="titlename"></result>
    <result property="creator" column="creator"></result>
    <result property="createTime" column="createTime"></result>
    <collection property="stList" ofType="secondTitle">
      <id property="sid" column="sid"></id>
      <result property="titleName" column="sttitlename"></result>
      <result property="newContent" column="stnewContent"></result>
      <result property="creator" column="stcreator"></result>
      <result property="createTime" column="stcreateTime"></result>
      <result property="parentTitleId" column="stparentTitleId"></result>
    </collection>
  </resultMap>
  
  <resultMap type="firstTitle" id="ftResultMapByLazy">
    <id property="fid" column="fid"></id>
    <result property="titleName" column="titlename"></result>
    <result property="creator" column="creator"></result>
    <result property="createTime" column="createTime"></result>
    <collection property="stList" 
                ofType="secondTitle" 
                select="mapper.SecondTitleMapper.selectSecondTitleByFidByLazy" 
                column="fid"/>
  </resultMap>

  <select id="selectFirstTitleById" parameterType="int" resultMap="ftResultMap">
    select f.*,
           s.sid,
           s.titlename sttitlename,
           s.newcontent stnewcontent,
           s.creator stcreator,
           s.createtime stcreatetime,
           s.parenttitleid stparenttitleid
    from firsttitle f left join secondtitle s
    on f.fid=s.parenttitleid
    where f.fid=#{param}
  </select>
  
  <select id="selectFirstTitleByIdByLazy" parameterType="int" resultType="firstTitle">
    select * from firsttitle where fid=#{param}
  </select>
  
  <select id="selectFirstTitleAll" resultMap="ftResultMap">
    select f.*,
           s.sid,
           s.titlename sttitlename,
           s.newcontent stnewcontent,
           s.creator stcreator,
           s.createtime stcreatetime,
           s.parenttitleid stparenttitleid
    from firsttitle f left join secondtitle s
    on f.fid=s.parenttitleid
    order by f.fid
  </select>
  
  <select id="selectFirstTitleAllByLazy" resultMap="ftResultMapByLazy">
    select * from firsttitle order by fid
  </select>
  
  <update id="updateFirstTitle" parameterType="firstTitle">
    update firsttitle set titlename = #{titleName}, creator = #{creator}, 
                                     createtime = #{createTime} where fid = #{fid}
  </update>
  
</mapper>     