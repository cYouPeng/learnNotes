<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>更新二级标题</title>
		<link rel="stylesheet" href="css/common.css" />
		<script type="text/javascript" src="../js/jquery-1.11.3.js"></script>
		<script type="text/javascript" src="../js/authorization.js"></script>
		<script type="text/javascript" src="../js/common.js"></script>
		<script>
			var sid = GetQueryString("sid");
			$(function(){
				var i = 0;
				var str = "";
				$.ajax({
			    	type:"post",
			        url:"../ft/selectFirstTitleAll.do",
			        success:function(data,stutas,xhr){
			        	for(i=0;i<data.length;i++){
			        		str += "<option value='"+data[i].fid+"'>"+data[i].titleName+"</option>";
			        	}
			        	$("#parentTitleId").html(str);
			        	selectSecond(sid);
			        },
			        error:function(xhr,error){
			        	alert("请求失败！");
			        }
				});
			});
			function selectSecond(){
				$.ajax({
			    	type:"post",
			        url:"../st/selectSecondTitleById.do",
			        data:{
			        	"sid":sid
			        },
			        success:function(data,stutas,xhr){
			        	$("#sid").html(data.sid);
			        	$("#titleName").val(data.titleName);
			        	$("#creator").val(data.creator);
			        	$("#newContent").val(data.newContent);
			        	$("#parentTitleId").val(data.parentTitleId);
			        },
			        error:function(xhr,error){
			        	alert("请求失败！");
			        }
				});
			}
			function update(){
				var titleName = $("#titleName").val();
				var newContent = $("#newContent").val();
				var creator = $("#creator").val();
				var parentTitleId = $("#parentTitleId").val();
				$.ajax({
			    	type:"post",
			        url:"../st/updateSecondTitle.do",
			        data:{
			        	"sid":sid,
			        	"titleName":titleName,
			        	"newContent":newContent,
			        	"creator":creator,
			        	"parentTitleId":parentTitleId
			        },
			        success:function(data,stutas,xhr){
			        	if(data=="1"){
			        		window.location.href="secondList.html";
			        	}else{
			        		window.location.href="error.html";
			        	}
			        },
			        error:function(xhr,error){
			        	alert("请求失败！");
			        }
				});
			}
		</script>
	</head>
	<body>
		<div class="container">
			<div class="box">
				<div class="title">
					<span>更新二级标题</span>
				</div>
				<div class="content">
					<form action="" method="post">
						<table>
							<tr>
								<td><span>二级标题ID</span></td><td id="sid">1</td>
							</tr>
							<tr>
								<td><span>二级标题名称</span></td><td><input type="text" name="titleName" id="titleName"/></td>
							</tr>
							<tr>
								<td><span>所属一级标题</span></td>
								<td>
									<select name="parentTitleId" id="parentTitleId">
										
									</select>
								</td>
							</tr>
							<tr>
								<td><span>创建者</span></td><td><input type="text" name="creator" id="creator"/></td>
							</tr>
							<tr>
								<td><span>二级标题内容</span></td>
								<td><textarea name="newContent" rows="6" cols="60" id="newContent"></textarea></td>
							</tr>
							<tr>
								<td></td><td><input type="button" value="更新" onclick="update()"/></td>
							</tr>
						</table>
					</form>
				</div>
			</div>
		</div>
	</body>
</html>
